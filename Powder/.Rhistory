for (i in 1:length(player$id)) {
player$last[i] <- max(master$last[which(master$player_id == player$id[i])])
}
for (i in 1:length(player$id)) {
teams <- master$team[which(master$player_id == player$id[i])]
if (length(teams) == 1) {
player$team[i] <- teams[1]
} else if (length(teams) > 1) {
oneteam <- TRUE
for (j in 1:length(teams)) {
if (j > 1) {
if (teams[j] != teams[j-1]) {
oneteam <- FALSE
}
}
}
if (oneteam) {
player$team[i] <- teams[1]
} else {
player$team[i] <- NA
}
} else {
player$team[i] <- NA
}
}
for (i in 1:length(player$id)) {
player$g[i] <- max(master$g[which(master$player_id == player$id[i])])
}
for (i in 1:length(player$id)) {
player$gs[i] <- max(master$gs[which(master$player_id == player$id[i])])
}
for (i in 1:length(player$id)) {
player$mp[i] <- mean(master$mp[which(master$player_id == player$id[i])], na.rm = TRUE)
}
for (i in 1:length(player$id)) {
player$pts[i] <- mean(master$pts[which(master$player_id == player$id[i])], na.rm = TRUE)
}
for (i in 1:length(player$id)) {
player$fga[i] <- mean(master$fga[which(master$player_id == player$id[i])], na.rm = TRUE)
}
for (i in 1:length(player$id)) {
player$fgm[i] <- mean(master$fgm[which(master$player_id == player$id[i])], na.rm = TRUE)
}
player$`fg%` <- player$fgm / player$fga
for (i in 1:length(player$id)) {
player$`3pa`[i] <- mean(master$X3pa[which(master$player_id == player$id[i])], na.rm = TRUE)
}
for (i in 1:length(player$id)) {
player$`3pm`[i] <- mean(master$X3pm[which(master$player_id == player$id[i])], na.rm = TRUE)
}
player$`3p%` <- player$`3pm` / player$`3pa`
for (i in 1:length(player$id)) {
player$fta[i] <- mean(master$fta[which(master$player_id == player$id[i])], na.rm = TRUE)
}
for (i in 1:length(player$id)) {
player$ftm[i] <- mean(master$ftm[which(master$player_id == player$id[i])], na.rm = TRUE)
}
player$`ft%` <- player$ftm / player$fta
for (i in 1:length(player$id)) {
player$oreb[i] <- mean(master$oreb[which(master$player_id == player$id[i])], na.rm = TRUE)
}
for (i in 1:length(player$id)) {
player$dreb[i] <- mean(master$dreb[which(master$player_id == player$id[i])], na.rm = TRUE)
}
for (i in 1:length(player$id)) {
player$treb[i] <- mean(master$treb[which(master$player_id == player$id[i])], na.rm = TRUE)
}
for (i in 1:length(player$id)) {
player$ast[i] <- mean(master$ast[which(master$player_id == player$id[i])], na.rm = TRUE)
}
for (i in 1:length(player$id)) {
player$stl[i] <- mean(master$stl[which(master$player_id == player$id[i])], na.rm = TRUE)
}
for (i in 1:length(player$id)) {
player$blk[i] <- mean(master$blk[which(master$player_id == player$id[i])], na.rm = TRUE)
}
for (i in 1:length(player$id)) {
player$tov[i] <- mean(master$tov[which(master$player_id == player$id[i])], na.rm = TRUE)
}
for (i in 1:length(player$id)) {
player$pf[i] <- mean(master$pf[which(master$player_id == player$id[i])], na.rm = TRUE)
}
# player <- player[-which(player$first == "Guest"),]
### Build leaderboards
pts_leader <- player[which(player$g > 1),][with(player[which(player$g > 1),],order(-pts)),][1:10,c(1:3, 8)]
mp_leader <- player[which(player$g > 1),][with(player[which(player$g > 1),],order(-mp)),][1:10,c(1:3, 7)]
reb_leader <- player[which(player$g > 1),][with(player[which(player$g > 1),],order(-treb)),][1:10,c(1:3, 20)]
ast_leader <- player[which(player$g > 1),][with(player[which(player$g > 1),],order(-ast)),][1:10,c(1:3, 21)]
blk_leader <- player[which(player$g > 1),][with(player[which(player$g > 1),],order(-blk)),][1:10,c(1:3, 23)]
stl_leader <- player[which(player$g > 1),][with(player[which(player$g > 1),],order(-stl)),][1:10,c(1:3, 22)]
# `fg%_leader` <- player[which(player$fga > 5),][with(player[which(player$fga > 5),],order(-`fg%`)),][1:10,c(1:3, 9:11)]
`fg%_leader` <- player[which(player$g > 1),][with(player[which(player$g > 1),],order(-`fg%`)),][1:10,c(1:3, 9:11)]
# `3p%_leader` <- player[which(player$`3pa` > 3),][with(player[which(player$`3pa` > 3),],order(-`3p%`)),][1:10,c(1:3, 12:14)]
p3int <- player[intersect(which(player$g > 1), which((player$`3pa` * player$g) > 5)),]
`3p%_leader` <-p3int[with(p3int,order(-`3p%`)),][1:10,c(1:3, 12:14)]
# `ft%_leader` <- player[which(player$fta > 2),][with(player[which(player$fta > 2),],order(-`ft%`)),][1:10,c(1:3, 15:17)]
ftint <- player[intersect(which(player$g > 1), which((player$fta * player$g) > 9)),]
`ft%_leader` <- ftint[with(ftint,order(-`ft%`)),][1:10,c(1:3, 15:17)]
## Add player averages to player.csv
write.csv(player, "Player.csv", row.names = FALSE)
##Write jsons to sportsdada
dates <- read.csv("game_dates.csv")
colnames(`fg%_leader`)[6] <- "fg"
colnames(`3p%_leader`)[6] <- "p3"
colnames(`ft%_leader`)[6] <- "ft"
colnames(master)[c(12, 19:22, 25)] <- c("num", "fgp", "thpa", "thpm", "thpp", "ftp")
colnames(player)[c(11:14, 17)] <- c("fgp", "thpa", "thpm", "thpp", "ftp")
player$mp <- round(as.numeric(player$mp), 1)
player$pts <- round(as.numeric(player$pts), 1)
player$treb <- round(as.numeric(player$treb), 1)
player$ast <- round(as.numeric(player$ast), 1)
player$fgp <- round((100* as.numeric(player$fgp)), 1)
player$thpp <- round((100* as.numeric(player$thpp)), 1)
player$ftp <- round((100* as.numeric(player$ftp)), 1)
player$oreb <- round(as.numeric(player$oreb), 1)
player$dreb <- round(as.numeric(player$dreb), 1)
player$stl <- round(as.numeric(player$stl), 1)
player$blk <- round(as.numeric(player$blk), 1)
player$fga <- round(as.numeric(player$fga), 1)
player$fgm <- round(as.numeric(player$fgm), 1)
player$thpa <- round(as.numeric(player$thpa), 1)
player$thpm <- round(as.numeric(player$thpm), 1)
player$fta <- round(as.numeric(player$fta), 1)
player$ftm <- round(as.numeric(player$ftm), 1)
player$tov <- round(as.numeric(player$tov), 1)
player$pf <- round(as.numeric(player$pf), 1)
player[is.na(player)] <- ""
player$team[which(player$team == "")] <- NA
team_data <- master[which(master$num=="Total:"),]
teams <- data.frame(team = unique(team_data$team))
teams$team_id <- unique(team_data$team_id)
winners <- team_data[which(team_data$team_id == team_data$winner),]
losers <- team_data[which(team_data$team_id != team_data$winner),]
for (i in 1:length(teams$team)) {
home <- team_data[which(team_data$home == teams$team_id[i]),]
away <- team_data[which(team_data$away == teams$team_id[i]),]
teams$w[i] <- length(winners[which(winners$team_id == teams$team_id[i]),]$date)
teams$l[i] <- length(losers[which(losers$team_id == teams$team_id[i]),]$date)
teams$home[i] <- paste0(length(winners[which(winners$team_id == teams$team_id[i]),][which(winners[which(
winners$team_id == teams$team_id[i]),]$home == winners[which(
winners$team_id == teams$team_id[i]),]$team_id),]$date), "-", (length(home$date) / 2)-as.numeric(length(winners[which(winners$team_id == teams$team_id[i]),][which(winners[which(
winners$team_id == teams$team_id[i]),]$home == winners[which(
winners$team_id == teams$team_id[i]),]$team_id),]$date)))
teams$away[i] <- paste0(length(winners[which(winners$team_id == teams$team_id[i]),][which(winners[which(
winners$team_id == teams$team_id[i]),]$home != winners[which(
winners$team_id == teams$team_id[i]),]$team_id),]$date), "-", (length(away$date) / 2)-as.numeric(length(winners[which(winners$team_id == teams$team_id[i]),][which(winners[which(
winners$team_id == teams$team_id[i]),]$home != winners[which(
winners$team_id == teams$team_id[i]),]$team_id),]$date)))
}
teams$pct <- round(as.numeric(teams$w) / (as.numeric(teams$w) + as.numeric(teams$l)), 2)
teams <- teams %>% arrange(desc(pct))
for (i in 1:length(teams$team)) {
teams$gb[i] <- ifelse(i == 1, 0, teams$w[1] - teams$w[i])
opponents <- team_data[which(team_data$team_id != teams$team_id[i]),]
teams$ppg[i] <- round(mean(team_data[which(team_data$team_id == teams$team_id[i]),]$pts, na.rm = TRUE), 1)
teams$oppg[i] <- round(mean(data.frame(rbind(opponents[which(opponents$home == teams$team_id[i]),],
opponents[which(opponents$away == teams$team_id[i]),]))$pts, na.rm = TRUE), 1)
teams$diff[i] <- round(as.numeric(teams$ppg[i]) - as.numeric(teams$oppg[i]), 1)
}
teams <- teams[, c(1, 3, 4, 7, 8, 5, 6, 9, 10, 11)]
team_stats <- data.frame(team = unique(team_data$team))
team_stats$team_id <- unique(team_data$team_id)
for (i in 1:length(team_stats$team)) {
team_stats$ppg[i] <- round(mean(team_data[which(team_data$team_id == team_stats$team_id[i]),]$pts, na.rm = TRUE), 1)
team_stats$treb[i] <- round(mean(team_data[which(team_data$team_id == team_stats$team_id[i]),]$treb, na.rm = TRUE), 1)
team_stats$ast[i] <- round(mean(team_data[which(team_data$team_id == team_stats$team_id[i]),]$ast, na.rm = TRUE), 1)
team_stats$treb[i] <- round(mean(team_data[which(team_data$team_id == team_stats$team_id[i]),]$treb, na.rm = TRUE), 1)
team_stats$fga[i] <- round(mean(team_data[which(team_data$team_id == team_stats$team_id[i]),]$fga, na.rm = TRUE), 1)
team_stats$fgm[i] <- round(mean(team_data[which(team_data$team_id == team_stats$team_id[i]),]$fgm, na.rm = TRUE), 1)
team_stats$fgp[i] <- round(100 * (team_stats$fgm[i] / team_stats$fga[i]), 1)
team_stats$thpa[i] <- round(mean(team_data[which(team_data$team_id == team_stats$team_id[i]),]$thpa, na.rm = TRUE), 1)
team_stats$thpm[i] <- round(mean(team_data[which(team_data$team_id == team_stats$team_id[i]),]$thpm, na.rm = TRUE), 1)
team_stats$thpp[i] <- round(100 * (team_stats$thpm[i] / team_stats$thpa[i]), 1)
team_stats$fta[i] <- round(mean(team_data[which(team_data$team_id == team_stats$team_id[i]),]$fta, na.rm = TRUE), 1)
team_stats$ftm[i] <- round(mean(team_data[which(team_data$team_id == team_stats$team_id[i]),]$ftm, na.rm = TRUE), 1)
team_stats$ftp[i] <- round(100 * (team_stats$ftm[i] / team_stats$fta[i]), 1)
team_stats$oreb[i] <- round(mean(team_data[which(team_data$team_id == team_stats$team_id[i]),]$oreb, na.rm = TRUE), 1)
team_stats$dreb[i] <- round(mean(team_data[which(team_data$team_id == team_stats$team_id[i]),]$dreb, na.rm = TRUE), 1)
team_stats$treb[i] <- round(mean(team_data[which(team_data$team_id == team_stats$team_id[i]),]$treb, na.rm = TRUE), 1)
team_stats$stl[i] <- round(mean(team_data[which(team_data$team_id == team_stats$team_id[i]),]$stl, na.rm = TRUE), 1)
team_stats$blk[i] <- round(mean(team_data[which(team_data$team_id == team_stats$team_id[i]),]$blk, na.rm = TRUE), 1)
team_stats$tov[i] <- round(mean(team_data[which(team_data$team_id == team_stats$team_id[i]),]$tov, na.rm = TRUE), 1)
team_stats$pf[i] <- round(mean(team_data[which(team_data$team_id == team_stats$team_id[i]),]$pf, na.rm = TRUE), 1)
}
View(pts_leader)
write_json(pts_leader, "../back-end/pts2021.json")
write_json(ast_leader, "../back-end/ast2021.json")
write_json(reb_leader, "../back-end/reb2021.json")
write_json(blk_leader, "../back-end/blk2021.json")
write_json(stl_leader, "../back-end/stl2021.json")
write_json(mp_leader, "../back-end/mp2021.json")
write_json(`3p%_leader`, "../back-end/pth2021.json")
write_json(`fg%_leader`, "../back-end/fg2021.json")
write_json(`ft%_leader`, "../back-end/ft2021.json")
write_json(player, "../back-end/players2021.json")
write_json(dates, "../back-end/game_dates2021.json")
write_json(master, "../back-end/master2021.json")
write_json(teams, "../back-end/teams2021.json")
write_json(team_stats, "../back-end/team_stats2021.json")
## Set up for gathering game data
rm(list = ls())
library(readxl)
library(xlsx)
library(dplyr)
day <- 22
week <- 1
month <- 6
game_num <- readRDS("gameNum.rds")
saveRDS("1", "gameNum.rds")
game_num <- readRDS("gameNum.rds")
saveRDS(1, "gameNum.rds")
game_num <- readRDS("gameNum.rds")
game_num <- readRDS("gameNum.rds")
master_box <- read.csv("Master.csv")
ids <- data.frame(team = c("Arok", "Berger", "Draney", "Roberts", "Clarke", "Humphries", "Dastrop",
"Drisdom", "Joyce", "Fulton", "Covington", "Egan"),
team_id = c("ARK", "BGR", "DNY", "RBT", "CLK", "HMP", "DTP", "DDM", "JYC", "FLN", "CVN", "EGN"))
View(master_box)
#args <- commandArgs(trailingOnly=TRUE)
args <- c(day, week, month)
dates <- read.csv("game_dates.csv")
paste0(args[3], "/", args[1], "/", 22)
day <- 15
#args <- commandArgs(trailingOnly=TRUE)
args <- c(day, week, month)
paste0(args[3], "/", args[1], "/", 22)
data.frame(rbind(paste0(args[3], "/", args[1], "/", 22), dates))
dates <- data.frame(rbind(paste0(args[3], "/", args[1], "/", 22), dates))
View(dates)
dates <- read.csv("game_dates.csv")
View(dates)
data.frame(dates=rbind(paste0(args[3], "/", args[1], "/", 22), dates))
rbind(paste0(args[3], "/", args[1], "/", 22), dates)
dates <- read.csv("game_dates.csv")
dates <- data.frame(rbind(paste0(args[3], "/", args[1], "/", 22), dates))
colnames(dates) <- c("dates")
View(dates)
pattern = paste0("G1 ", args[3], "-", args[1], "(.*)xlsm$")
paste0("G1 ", args[3], "-", args[1], "(.*)xlsm$")
paste0("Week", args[2], "/")
list.files(pattern = paste0("G1 ", args[3], "-", args[1], "(.*)xlsm$"), path = paste0("Week", args[2], "/"))
## Set up for gathering game data
rm(list = ls())
library(readxl)
library(xlsx)
library(dplyr)
#########################################################
####################################################
## Create player averages and upload json files #############
####################################################
####################################################
library(jsonlite)
library(dplyr)
rm(list = ls())
master <- read.csv(file = "Master.csv")
player <- data.frame(id = unique(master$player_id))
player <- data.frame(id = player[-c(which(player$id == "")),])
player <- data.frame(id = player[-c(which(player$id == "Stats")),])
# player <- data.frame(id = player[-which(player$id == "festusndumanya_02"),])
for (i in 1:length(player$id)) {
player$first[i] <- max(master$first[which(master$player_id == player$id[i])])
}
for (i in 1:length(player$id)) {
player$last[i] <- max(master$last[which(master$player_id == player$id[i])])
}
for (i in 1:length(player$id)) {
teams <- master$team[which(master$player_id == player$id[i])]
if (length(teams) == 1) {
player$team[i] <- teams[1]
} else if (length(teams) > 1) {
oneteam <- TRUE
for (j in 1:length(teams)) {
if (j > 1) {
if (teams[j] != teams[j-1]) {
oneteam <- FALSE
}
}
}
if (oneteam) {
player$team[i] <- teams[1]
} else {
player$team[i] <- NA
}
} else {
player$team[i] <- NA
}
}
for (i in 1:length(player$id)) {
player$g[i] <- max(master$g[which(master$player_id == player$id[i])])
}
for (i in 1:length(player$id)) {
player$gs[i] <- max(master$gs[which(master$player_id == player$id[i])])
}
for (i in 1:length(player$id)) {
player$mp[i] <- mean(master$mp[which(master$player_id == player$id[i])], na.rm = TRUE)
}
for (i in 1:length(player$id)) {
player$pts[i] <- mean(master$pts[which(master$player_id == player$id[i])], na.rm = TRUE)
}
for (i in 1:length(player$id)) {
player$fga[i] <- mean(master$fga[which(master$player_id == player$id[i])], na.rm = TRUE)
}
for (i in 1:length(player$id)) {
player$fgm[i] <- mean(master$fgm[which(master$player_id == player$id[i])], na.rm = TRUE)
}
player$`fg%` <- player$fgm / player$fga
for (i in 1:length(player$id)) {
player$`3pa`[i] <- mean(master$X3pa[which(master$player_id == player$id[i])], na.rm = TRUE)
}
for (i in 1:length(player$id)) {
player$`3pm`[i] <- mean(master$X3pm[which(master$player_id == player$id[i])], na.rm = TRUE)
}
player$`3p%` <- player$`3pm` / player$`3pa`
for (i in 1:length(player$id)) {
player$fta[i] <- mean(master$fta[which(master$player_id == player$id[i])], na.rm = TRUE)
}
for (i in 1:length(player$id)) {
player$ftm[i] <- mean(master$ftm[which(master$player_id == player$id[i])], na.rm = TRUE)
}
player$`ft%` <- player$ftm / player$fta
for (i in 1:length(player$id)) {
player$oreb[i] <- mean(master$oreb[which(master$player_id == player$id[i])], na.rm = TRUE)
}
for (i in 1:length(player$id)) {
player$dreb[i] <- mean(master$dreb[which(master$player_id == player$id[i])], na.rm = TRUE)
}
for (i in 1:length(player$id)) {
player$treb[i] <- mean(master$treb[which(master$player_id == player$id[i])], na.rm = TRUE)
}
for (i in 1:length(player$id)) {
player$ast[i] <- mean(master$ast[which(master$player_id == player$id[i])], na.rm = TRUE)
}
for (i in 1:length(player$id)) {
player$stl[i] <- mean(master$stl[which(master$player_id == player$id[i])], na.rm = TRUE)
}
for (i in 1:length(player$id)) {
player$blk[i] <- mean(master$blk[which(master$player_id == player$id[i])], na.rm = TRUE)
}
for (i in 1:length(player$id)) {
player$tov[i] <- mean(master$tov[which(master$player_id == player$id[i])], na.rm = TRUE)
}
for (i in 1:length(player$id)) {
player$pf[i] <- mean(master$pf[which(master$player_id == player$id[i])], na.rm = TRUE)
}
# player <- player[-which(player$first == "Guest"),]
### Build leaderboards
pts_leader <- player[which(player$g >= 1),][with(player[which(player$g >= 1),],order(-pts)),][1:10,c(1:3, 8)]
mp_leader <- player[which(player$g >= 1),][with(player[which(player$g >= 1),],order(-mp)),][1:10,c(1:3, 7)]
reb_leader <- player[which(player$g >= 1),][with(player[which(player$g >= 1),],order(-treb)),][1:10,c(1:3, 20)]
ast_leader <- player[which(player$g >= 1),][with(player[which(player$g >= 1),],order(-ast)),][1:10,c(1:3, 21)]
blk_leader <- player[which(player$g >= 1),][with(player[which(player$g >= 1),],order(-blk)),][1:10,c(1:3, 23)]
stl_leader <- player[which(player$g >= 1),][with(player[which(player$g >= 1),],order(-stl)),][1:10,c(1:3, 22)]
# `fg%_leader` <- player[which(player$fga > 5),][with(player[which(player$fga > 5),],order(-`fg%`)),][1:10,c(1:3, 9:11)]
`fg%_leader` <- player[which(player$g >= 1),][with(player[which(player$g >= 1),],order(-`fg%`)),][1:10,c(1:3, 9:11)]
# `3p%_leader` <- player[which(player$`3pa` > 3),][with(player[which(player$`3pa` > 3),],order(-`3p%`)),][1:10,c(1:3, 12:14)]
p3int <- player[intersect(which(player$g >= 1), which((player$`3pa` * player$g) >= 1)),]
`3p%_leader` <- p3int[with(p3int,order(-`3p%`)),][1:10,c(1:3, 12:14)]
# `ft%_leader` <- player[which(player$fta > 2),][with(player[which(player$fta > 2),],order(-`ft%`)),][1:10,c(1:3, 15:17)]
ftint <- player[intersect(which(player$g >= 1), which((player$fta * player$g) >= 1)),]
`ft%_leader` <- ftint[with(ftint,order(-`ft%`)),][1:10,c(1:3, 15:17)]
## Add player averages to player.csv
View(player)
read.csv("Player.csv")
player <- read.csv("Player.csv")
View(player)
dates <- read.csv("game_dates.csv")
colnames(`fg%_leader`)[6] <- "fg"
colnames(`3p%_leader`)[6] <- "p3"
colnames(`ft%_leader`)[6] <- "ft"
colnames(master)[c(12, 19:22, 25)] <- c("num", "fgp", "thpa", "thpm", "thpp", "ftp")
colnames(player)[c(11:14, 17)] <- c("fgp", "thpa", "thpm", "thpp", "ftp")
player$mp <- round(as.numeric(player$mp), 1)
player$pts <- round(as.numeric(player$pts), 1)
player$treb <- round(as.numeric(player$treb), 1)
player$ast <- round(as.numeric(player$ast), 1)
player$fgp <- round((100* as.numeric(player$fgp)), 1)
player$thpp <- round((100* as.numeric(player$thpp)), 1)
player$ftp <- round((100* as.numeric(player$ftp)), 1)
player$oreb <- round(as.numeric(player$oreb), 1)
player$dreb <- round(as.numeric(player$dreb), 1)
player$stl <- round(as.numeric(player$stl), 1)
player$blk <- round(as.numeric(player$blk), 1)
player$fga <- round(as.numeric(player$fga), 1)
player$fgm <- round(as.numeric(player$fgm), 1)
player$thpa <- round(as.numeric(player$thpa), 1)
player$thpm <- round(as.numeric(player$thpm), 1)
player$fta <- round(as.numeric(player$fta), 1)
player$ftm <- round(as.numeric(player$ftm), 1)
player$tov <- round(as.numeric(player$tov), 1)
player$pf <- round(as.numeric(player$pf), 1)
player[is.na(player)] <- ""
player$team[which(player$team == "")] <- NA
team_data <- master[which(master$num=="Total:"),]
teams <- data.frame(team = unique(team_data$team))
teams$team_id <- unique(team_data$team_id)
winners <- team_data[which(team_data$team_id == team_data$winner),]
losers <- team_data[which(team_data$team_id != team_data$winner),]
for (i in 1:length(teams$team)) {
home <- team_data[which(team_data$home == teams$team_id[i]),]
away <- team_data[which(team_data$away == teams$team_id[i]),]
teams$w[i] <- length(winners[which(winners$team_id == teams$team_id[i]),]$date)
teams$l[i] <- length(losers[which(losers$team_id == teams$team_id[i]),]$date)
teams$home[i] <- paste0(length(winners[which(winners$team_id == teams$team_id[i]),][which(winners[which(
winners$team_id == teams$team_id[i]),]$home == winners[which(
winners$team_id == teams$team_id[i]),]$team_id),]$date), "-", (length(home$date) / 2)-as.numeric(length(winners[which(winners$team_id == teams$team_id[i]),][which(winners[which(
winners$team_id == teams$team_id[i]),]$home == winners[which(
winners$team_id == teams$team_id[i]),]$team_id),]$date)))
teams$away[i] <- paste0(length(winners[which(winners$team_id == teams$team_id[i]),][which(winners[which(
winners$team_id == teams$team_id[i]),]$home != winners[which(
winners$team_id == teams$team_id[i]),]$team_id),]$date), "-", (length(away$date) / 2)-as.numeric(length(winners[which(winners$team_id == teams$team_id[i]),][which(winners[which(
winners$team_id == teams$team_id[i]),]$home != winners[which(
winners$team_id == teams$team_id[i]),]$team_id),]$date)))
}
teams$pct <- round(as.numeric(teams$w) / (as.numeric(teams$w) + as.numeric(teams$l)), 2)
teams <- teams %>% arrange(desc(pct))
for (i in 1:length(teams$team)) {
teams$gb[i] <- ifelse(i == 1, 0, teams$w[1] - teams$w[i])
opponents <- team_data[which(team_data$team_id != teams$team_id[i]),]
teams$ppg[i] <- round(mean(team_data[which(team_data$team_id == teams$team_id[i]),]$pts, na.rm = TRUE), 1)
teams$oppg[i] <- round(mean(data.frame(rbind(opponents[which(opponents$home == teams$team_id[i]),],
opponents[which(opponents$away == teams$team_id[i]),]))$pts, na.rm = TRUE), 1)
teams$diff[i] <- round(as.numeric(teams$ppg[i]) - as.numeric(teams$oppg[i]), 1)
}
teams <- teams[, c(1, 3, 4, 7, 8, 5, 6, 9, 10, 11)]
team_stats <- data.frame(team = unique(team_data$team))
team_stats$team_id <- unique(team_data$team_id)
for (i in 1:length(team_stats$team)) {
team_stats$ppg[i] <- round(mean(team_data[which(team_data$team_id == team_stats$team_id[i]),]$pts, na.rm = TRUE), 1)
team_stats$treb[i] <- round(mean(team_data[which(team_data$team_id == team_stats$team_id[i]),]$treb, na.rm = TRUE), 1)
team_stats$ast[i] <- round(mean(team_data[which(team_data$team_id == team_stats$team_id[i]),]$ast, na.rm = TRUE), 1)
team_stats$treb[i] <- round(mean(team_data[which(team_data$team_id == team_stats$team_id[i]),]$treb, na.rm = TRUE), 1)
team_stats$fga[i] <- round(mean(team_data[which(team_data$team_id == team_stats$team_id[i]),]$fga, na.rm = TRUE), 1)
team_stats$fgm[i] <- round(mean(team_data[which(team_data$team_id == team_stats$team_id[i]),]$fgm, na.rm = TRUE), 1)
team_stats$fgp[i] <- round(100 * (team_stats$fgm[i] / team_stats$fga[i]), 1)
team_stats$thpa[i] <- round(mean(team_data[which(team_data$team_id == team_stats$team_id[i]),]$thpa, na.rm = TRUE), 1)
team_stats$thpm[i] <- round(mean(team_data[which(team_data$team_id == team_stats$team_id[i]),]$thpm, na.rm = TRUE), 1)
team_stats$thpp[i] <- round(100 * (team_stats$thpm[i] / team_stats$thpa[i]), 1)
team_stats$fta[i] <- round(mean(team_data[which(team_data$team_id == team_stats$team_id[i]),]$fta, na.rm = TRUE), 1)
team_stats$ftm[i] <- round(mean(team_data[which(team_data$team_id == team_stats$team_id[i]),]$ftm, na.rm = TRUE), 1)
team_stats$ftp[i] <- round(100 * (team_stats$ftm[i] / team_stats$fta[i]), 1)
team_stats$oreb[i] <- round(mean(team_data[which(team_data$team_id == team_stats$team_id[i]),]$oreb, na.rm = TRUE), 1)
team_stats$dreb[i] <- round(mean(team_data[which(team_data$team_id == team_stats$team_id[i]),]$dreb, na.rm = TRUE), 1)
team_stats$treb[i] <- round(mean(team_data[which(team_data$team_id == team_stats$team_id[i]),]$treb, na.rm = TRUE), 1)
team_stats$stl[i] <- round(mean(team_data[which(team_data$team_id == team_stats$team_id[i]),]$stl, na.rm = TRUE), 1)
team_stats$blk[i] <- round(mean(team_data[which(team_data$team_id == team_stats$team_id[i]),]$blk, na.rm = TRUE), 1)
team_stats$tov[i] <- round(mean(team_data[which(team_data$team_id == team_stats$team_id[i]),]$tov, na.rm = TRUE), 1)
team_stats$pf[i] <- round(mean(team_data[which(team_data$team_id == team_stats$team_id[i]),]$pf, na.rm = TRUE), 1)
}
pts_leader
player
dates
master
teams
team_stats
`ft%_leader`
player[c(1, 2, 3)]
player[c(1, 2, 3, 21)]
ast_leader <- player[c(1, 2, 3, 21)]
pts_leader <- player[c(1, 2, 3, 8)]
reb_leader <- player[c(1:3, 20)]
blk_leader <- player[c(1:3, 23)]
stl_leader <- player[c(1:3, 22)]
`3p%_leader` <- player[c(1:3, 12:14)]
colnames(`3p%_leader`) <- c("id", "first", "last", "3pa", "3pm", "p3")
`fg%_leader` <- player[c(1:3, 9:11)]
colnames(`fg%_leader`) <- c("id", "first", "last", "fga", "fgm", "fg")
`ft%_leader` <- player[c(1:3, 15:17)]
colnames(`ft%_leader`) <- c("id", "first", "last", "fta", "ftm", "ft")
pts_leader
ast_leader
reb_leader
blk_leader
mp_leader
_leader
`3p%_leader`
`fg%_leader`
`ft%_leader`
player
dates
master
teams
team_stats
team$w <- NULL
teams$w <- NULL
teams
teams$w <- c()
teams
teams$w <- NA
teams['w'] <- NA
write_json(pts_leader, "../back-end/pts.json")
write_json(ast_leader, "../back-end/ast.json")
write_json(reb_leader, "../back-end/reb.json")
write_json(blk_leader, "../back-end/blk.json")
write_json(stl_leader, "../back-end/stl.json")
write_json(mp_leader, "../back-end/mp.json")
write_json(`3p%_leader`, "../back-end/pth.json")
write_json(`fg%_leader`, "../back-end/fg.json")
write_json(`ft%_leader`, "../back-end/ft.json")
write_json(player, "../back-end/players.json")
write_json(dates, "../back-end/game_dates.json")
write_json(master, "../back-end/master.json")
write_json(teams, "../back-end/teams.json")
write_json(team_stats, "../back-end/team_stats.json")
reb_leader <- player[c(1:3, 7)]
mp_leader <- player[c(1:3, 7)]
write_json(mp_leader, "../back-end/mp.json")
ids <- data.frame(team = c("Bullock", "Stan", "Draney", "Roberts", "Clarke", "Humpherys", "Dastrop",
"Drisdom", "Joyce", "Fulton", "Covington", "Egan"),
team_id = c("BUL", "BGR", "STN", "RBT", "CLK", "HMP", "DTP", "DDM", "JYC", "FLN", "CVN", "EGN"))
ids <- data.frame(team = c("Bullock", "Stan", "Draney", "Erickson", "Humpherys",
"Drisdom", "Joyce", "Covington", "Egan"),
team_id = c("BUL", "BGR", "STN", "ERK", "HMP", "DDM", "JYC", "CVN", "EGN"))
